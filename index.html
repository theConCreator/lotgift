<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Telegram Slot Machine ðŸŽ°</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- React -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <!-- Lottie -->
  <script src="https://unpkg.com/lottie-web/build/player/lottie_light.min.js"></script>
  <style>
    body { background: linear-gradient(to bottom, #2e026d, #000); }
    .slot { width: 80px; height: 80px; background: white; border-radius: 12px; overflow: hidden; }
  </style>
</head>
<body class="text-white flex items-center justify-center min-h-screen">
  <div id="root"></div>

  <script type="text/javascript">
    const { useState, useEffect, useRef } = React;

    // ðŸŽ ÐŸÐ¾Ð´Ð°Ñ€ÐºÐ¸
    const gifts = [
      { name: "Hypno Lollipop", price: 1.77, file: "./assets/gifts/Hypno Lollipop.json" },
      { name: "Desk Calendar", price: 1.31, file: "./assets/gifts/Desk Calendar.json" },
      { name: "B-Day Candle", price: 1.32, file: "./assets/gifts/B-Day Candle.json" },
      { name: "Lol Pop", price: 1.32, file: "./assets/gifts/Lol Pop.json" },
      { name: "Lunar Snake", price: 1.38, file: "./assets/gifts/Lunar Snake.json" },
      { name: "Snake Box", price: 1.36, file: "./assets/gifts/Snake Box.json" },
      // ðŸ‘‰ Ð´Ð¾Ð±Ð°Ð²ÑŒ Ð¾ÑÑ‚Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ð¾ ÑÐ¿Ð¸ÑÐºÑƒ
    ];

    // ðŸ”¹ ÐžÐ´Ð¸Ð½ ÑÐ»Ð¾Ñ‚ (ÑÑ‡ÐµÐ¹ÐºÐ°)
    function Slot({ gift, spinning }) {
      const ref = useRef(null);

      useEffect(() => {
        if (!gift) return;
        ref.current.innerHTML = ""; // Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐ° Ð¿ÐµÑ€ÐµÐ´ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¾Ð¹

        lottie.loadAnimation({
          container: ref.current,
          renderer: "svg",
          loop: false,
          autoplay: !spinning, // ÐµÑÐ»Ð¸ ÐºÑ€ÑƒÑ‚Ð¸Ð¼ â€” Ð·Ð°Ð¼Ð¾Ñ€Ð¾Ð¶ÐµÐ½ Ð¿ÐµÑ€Ð²Ñ‹Ð¹ ÐºÐ°Ð´Ñ€
          path: gift.file,
        });
      }, [gift, spinning]);

      return React.createElement("div", { className: "slot flex items-center justify-center" },
        React.createElement("div", { ref })
      );
    }

    // ðŸŽ° ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚
    function SlotMachine() {
      const [slots, setSlots] = useState([null, null, null]);
      const [spinning, setSpinning] = useState(false);
      const [result, setResult] = useState(null);

      const spin = () => {
        setSpinning(true);
        setResult(null);

        let ticks = 0;
        const interval = setInterval(() => {
          setSlots([
            gifts[Math.floor(Math.random() * gifts.length)],
            gifts[Math.floor(Math.random() * gifts.length)],
            gifts[Math.floor(Math.random() * gifts.length)],
          ]);
          ticks++;
          if (ticks > 20) {
            clearInterval(interval);
            setSpinning(false);

            const final = [
              gifts[Math.floor(Math.random() * gifts.length)],
              gifts[Math.floor(Math.random() * gifts.length)],
              gifts[Math.floor(Math.random() * gifts.length)],
            ];
            setSlots(final);

            if (final[0].name === final[1].name && final[1].name === final[2].name) {
              setResult(`ðŸŽ‰ Ð¢Ñ‹ Ð²Ñ‹Ð¸Ð³Ñ€Ð°Ð» ${final[0].name}!`);
            } else {
              setResult("ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹ ÑÐ½Ð¾Ð²Ð° ðŸ˜‰");
            }
          }
        }, 100);
      };

      return (
        React.createElement("div", { className: "flex flex-col items-center" },
          React.createElement("div", { className: "relative w-[400px] h-[400px]" },
            React.createElement("div", { id: "slot-machine", className: "absolute inset-0" }),
            React.createElement("div", { className: "absolute top-[120px] left-[70px] flex gap-8" },
              slots.map((gift, i) =>
                React.createElement(Slot, { key: i, gift, spinning })
              )
            )
          ),
          React.createElement("button", {
            onClick: spin,
            disabled: spinning,
            className: "mt-4 px-6 py-2 bg-purple-600 text-white rounded-xl shadow-lg disabled:opacity-50"
          }, spinning ? "ÐšÑ€ÑƒÑ‚Ð¸Ð¼..." : "Spin ðŸŽ°"),
          result && React.createElement("p", { className: "mt-3 text-xl" }, result)
        )
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(React.createElement(SlotMachine));

    // Ð¤Ð¾Ð½ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð°
    lottie.loadAnimation({
      container: document.getElementById("slot-machine"),
      renderer: "svg",
      loop: true,
      autoplay: true,
      path: "./assets/777.json"
    });
  </script>
</body>
</html>
